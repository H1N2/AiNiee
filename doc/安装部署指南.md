# AiNiee 安装部署指南

## 系统要求
- **操作系统**：Windows 10/11、macOS、Linux
- **Python版本**：Python 3.12
- **内存要求**：建议 4GB 以上
- **存储空间**：至少 2GB 可用空间
- **网络要求**：稳定的互联网连接（使用在线API时）

## 安装方式

### 方式一：下载预编译版本（推荐）
1. 访问 [GitHub Releases](https://github.com/NEKOparapa/AiNiee/releases)
2. 下载最新版本的可执行文件
3. 解压到目标目录
4. 双击运行 `AiNiee.exe`

### 方式二：从源码安装
#### 1. 安装 Python 环境
```bash
# 确保安装 Python 3.12
python --version
```

#### 2. 克隆项目
```bash
git clone https://github.com/NEKOparapa/AiNiee.git
cd AiNiee
```

#### 3. 安装依赖
```bash
# 安装完整依赖
pip install -r requirements.txt

# 或安装精简依赖（不包含某些可选功能）
pip install -r requirements_no_deps.txt
```

#### 4. 运行程序
```bash
python AiNiee.py
```

## 依赖说明

### 核心依赖
```
PyQt5                    # GUI框架
openai                   # OpenAI API
anthropic                # Claude API
google-genai             # Google Gemini API
tiktoken                 # Token计算
requests                 # HTTP请求
rapidjson                # JSON处理
```

### 文件处理依赖
```
openpyxl                 # Excel文件处理
beautifulsoup4           # HTML/XML解析
lxml                     # XML处理
chardet                  # 字符编码检测
PyYAML                   # YAML文件处理
polib                    # PO文件处理
pandas                   # 数据处理
```

### AI相关依赖
```
spacy                    # 自然语言处理
sudachipy                # 日语分词
tiktoken                 # Token计算
cohere                   # Cohere API
boto3                    # AWS服务
```

### 文档处理依赖
```
pymupdf                  # PDF处理
pdfminer-six            # PDF文本提取
rapidocr-onnxruntime    # OCR功能
onnx                    # 机器学习模型
onnxruntime             # 模型运行时
```

## 配置文件

### 主配置文件
- 位置：`Resource/config.json`
- 包含：API配置、翻译设置、界面设置等

### 本地化文件
- 位置：`Resource/Localization/`
- 支持多语言界面

### 正则表达式库
- 位置：`Resource/Regex/regex.json`
- 用于文本预处理和格式识别

## 环境变量配置（可选）
```bash
# 设置代理（如需要）
export HTTP_PROXY=http://proxy.example.com:8080
export HTTPS_PROXY=http://proxy.example.com:8080

# 设置API密钥（可选，也可在界面中配置）
export OPENAI_API_KEY=your_openai_key
export ANTHROPIC_API_KEY=your_claude_key
```

## 打包部署（开发者）

### 使用 PyInstaller 打包
```bash
# 安装打包工具
pip install pyinstaller

# 打包为单个可执行文件
pyinstaller --onefile --windowed AiNiee.py

# 打包为文件夹（推荐，启动速度更快）
pyinstaller --onedir --windowed AiNiee.py
```

### 打包配置优化
创建 `AiNiee.spec` 文件进行高级配置：
```python
# -*- mode: python ; coding: utf-8 -*-
a = Analysis(
    ['AiNiee.py'],
    pathex=[],
    binaries=[],
    datas=[
        ('Resource', 'Resource'),
        ('ModuleFolders', 'ModuleFolders'),
        ('UserInterface', 'UserInterface'),
        ('Widget', 'Widget'),
    ],
    hiddenimports=[],
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=None,
    noarchive=False,
)
pyz = PYZ(a.pure, a.zipped_data, cipher=None)

exe = EXE(
    pyz,
    a.scripts,
    [],
    exclude_binaries=True,
    name='AiNiee',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    console=False,
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon='icon.ico'  # 如果有图标文件
)

coll = COLLECT(
    exe,
    a.binaries,
    a.zipfiles,
    a.datas,
    strip=False,
    upx=True,
    upx_exclude=[],
    name='AiNiee'
)
```

## 常见安装问题

### 1. Python版本不兼容
```bash
# 检查Python版本
python --version

# 如果版本不对，请安装Python 3.12
```

### 2. 依赖安装失败
```bash
# 升级pip
pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 3. PyQt5 安装问题
```bash
# Windows系统可能需要安装Visual C++运行库
# 或者尝试安装预编译版本
pip install PyQt5 --only-binary=all
```

### 4. GPU相关依赖问题
```bash
# 如果不需要GPU加速，可以跳过相关依赖
# 或者安装CPU版本
pip install onnxruntime  # 而不是 onnxruntime-gpu
```

## 性能优化建议

### 1. 内存优化
- 处理大文件时建议分批处理
- 及时清理缓存文件

### 2. 网络优化
- 使用稳定的网络连接
- 配置合适的请求间隔
- 使用多个API密钥进行负载均衡

### 3. 存储优化
- 定期清理临时文件
- 使用SSD存储提升文件读写速度

## 更新升级
1. 备份当前配置文件 `Resource/config.json`
2. 下载新版本
3. 复制配置文件到新版本目录
4. 运行新版本程序